## 2.5 TEN Framework：为语音而生的编排框架

在众多编排框架中，**[TEN Framework](https://github.com/TEN-framework/ten-framework)** 是专为实时语音代理设计的系统。 它把整个代理建模为一个由节点（extensions）和连接边组成的（graph）。每个节点执行特定任务，每条边表示数据或控制流。这个图可以静态定义，也可以在运行时动态生成与替换。

### 2.5.1 Graph as Contract

在 TEN 的理念中，**图本身就是系统的契约**。开发者通过定义图结构，明确模块的输入、输出以及它们之间的关系。系统在执行时依据这个图自动调度任务，而不是依靠手写的控制逻辑。

TEN 区分不同类型的消息：

- `command`（控制命令）
- `data`（结构化数据）
- `audio_frame` / `video_frame`（媒体帧）

这种区分让不同语言（C++、Go、Python、JS）编写的模块能无缝协作。
控制平面管理命令逻辑，数据平面负责实时音视频流。

### 2.5.2 并发与安全

TEN 在编排层引入了**所有权语义**，确保跨线程并发安全。消息一旦被发送，发送方放弃所有权，接收方接管并可借用或归还。 这种机制防止了音频缓冲区在多线程访问时的竞争问题。配套的工具（如 `tman check graph`）可在运行前验证数据结构与连接的正确性。

### 2.5.3 端云协同

TEN 支持在边缘端与云端之间灵活分布模块。延迟敏感的任务（如 VAD 或 Turn Detection）可以放在设备本地执行，而计算密集的 LLM 推理则留在云端。框架会自动处理跨进程、跨设备的通信。